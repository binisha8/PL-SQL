CREATE TABLE ORDERS(
    OREDR_ID INT PRIMARY KEY,
    CUSTOMER_ID INT,
    ORDER_DATE DATE,
    TOTAL_AMT DECIMAL(10,2)
);
INSERT INTO ORDERS VALUES(1,1,TO_DATE('25-JAN-1995','DD-MON-YYYY'),100);
INSERT INTO ORDERS VALUES(2,1,TO_DATE('15-MAR-2023','DD-MON-YYYY'),200);
INSERT INTO ORDERS VALUES(3,2,TO_DATE('20-MAR-2020','DD-MON-YYYY'),150);
INSERT INTO IRDERS VALUES(4,2,TO_DATE('01-APR-2023','DD-MM-YYYY'),130);

SELECT CUSTOMER_ID,OREDR_ID,ORDER_DATE,TOTAL_AMT,(
    SELECT MAX(TOTAL_AMT)
    FROM ORDERS O2
    WHERE O2.CUSTOMER_ID=O1.CUSTOMER_ID
     AND O2.ORDER_DATE=O1.ORDER_DATE
)AS PREVIOUS_MAX_ORDER
FROM ORDERS O1;



CREATE TABLE EMPLOYEE_M
(
    EMPLOYEE_ID INT,
    SALARY NUMBER
  
);
INSERT INTO EMPLOYEE_M (EMPLOYEE_ID, SALARY)
VALUES (1, 45000);

INSERT INTO EMPLOYEE_M (EMPLOYEE_ID, SALARY)
VALUES (2, 55000);

INSERT INTO EMPLOYEE_M (EMPLOYEE_ID, SALARY)
VALUES (3, 60000);
CREATE TABLE EMPLOYEE_MASTER
(
    EMPLOYEE_ID INT,
    SALARY NUMBER,
    UPDATED_DATE DATE
);

SELECT * FROM EMPLOYEES;
-- Insert a single record
INSERT INTO EMPLOYEE_MASTER (EMPLOYEE_ID, SALARY, UPDATED_DATE)
VALUES (1, 50000, TO_DATE('2025-11-14', 'YYYY-MM-DD'));

-- Insert multiple records
INSERT INTO EMPLOYEE_MASTER (EMPLOYEE_ID, SALARY, UPDATED_DATE)
VALUES (2, 60000, TO_DATE('2025-11-14', 'YYYY-MM-DD'));

INSERT INTO EMPLOYEE_MASTER (EMPLOYEE_ID, SALARY, UPDATED_DATE)
VALUES (10, 75000, TO_DATE('2025-11-14', 'YYYY-MM-DD'));

-- Merge data
MERGE INTO EMPLOYEE_M E
USING EMPLOYEE_MASTER EM
ON (E.EMPLOYEE_ID = EM.EMPLOYEE_ID)
WHEN MATCHED THEN
    UPDATE SET E.SALARY = EM.SALARY
WHEN NOT MATCHED THEN
    INSERT (EMPLOYEE_ID, SALARY)
    VALUES (EM.EMPLOYEE_ID, EM.SALARY);

-- Check result
SELECT * FROM EMPLOYEE_M;




--1
CREATE TABLE EMPLOYEES(
    EMP_NAME VARCHAR(20),
    EMPLOYEE_ID INT,
    SALARY NUMBER(10,2)
);

CREATE TABLE BONUS_EMPLOYEE(
    EMP_NAME VARCHAR(20),
    EMPLOYEE_ID INT,
    BONUS_AMOUNT NUMBER(10,2)
   
);


INSERT INTO BONUS_EMPLOYEE VALUES ('Ambika',1,1200);
INSERT INTO BONUS_EMPLOYEE VALUES('Ishan',2,3200);
INSERT INTO BONUS_EMPLOYEE VALUES ('Isha',3,3200);
INSERT INTO BONUS_EMPLOYEE VALUES ('Ram',7,4500);
INSERT INTO BONUS_EMPLOYEE VALUES('Bindu',5,2200);
INSERT INTO BONUS_EMPLOYEE VALUES ('sangit',6,NULL);


INSERT INTO EMPLOYEES VALUES ('Ambika',1,70000);
INSERT INTO EMPLOYEES VALUES ('Ishan',2,60000);
INSERT INTO EMPLOYEES VALUES ('Isha',3,70000);
INSERT INTO EMPLOYEES VALUES ('yashna',13,75000);
INSERT INTO EMPLOYEES VALUES ('Bindu',14,NULL);
INSERT INTO EMPLOYEES VALUES ('Ram',7,NULL);


MERGE INTO EMPLOYEES  E USING BONUS_EMPLOYEE D
ON(E.EMPLOYEE_ID=D.EMPLOYEE_ID)
WHEN MATCHED THEN
    UPDATE SET E.SALARY=E.SALARY + D.BONUS_AMOUNT
WHEN NOT MATCHED THEN
    INSERT(EMP_NAME,EMPLOYEE_ID,SALARY) VALUES (D.EMP_NAME,D.EMPLOYEE_ID,5000);

SELECT * FROM EMPLOYEES;


CREATE TABLE DEPT_SALARY_ADJUSTMENT
(
    DEPARTMENT_ID INT PRIMARY KEY,
    ADJUSTMENT_PERCENT NUMBER(5,2) 
);

INSERT INTO  DEPT_SALARY_ADJUSTMENT VALUES (100,5);
INSERT INTO  DEPT_SALARY_ADJUSTMENT VALUES (1,0.5);
INSERT INTO  DEPT_SALARY_ADJUSTMENT VALUES (1,8);
INSERT INTO  DEPT_SALARY_ADJUSTMENT VALUES (2,2);
INSERT INTO  DEPT_SALARY_ADJUSTMENT VALUES (3,2);



CREATE TABLE emp (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(100) NOT NULL,
    job_title VARCHAR(50),
    salary DECIMAL(10, 2),
    department_id INT,
    FOREIGN KEY (department_id) REFERENCES DEPT_SALARY_ADJUSTMENT(department_id)
);

INSERT INTO emp (emp_id, emp_name, job_title, salary, department_id)
VALUES (101, 'Alice Sharma', 'HR Manager', 55000.00, 1);

INSERT INTO emp (emp_id, emp_name, job_title, salary, department_id)
VALUES (102, 'Binisha Maharjan', 'Trainee', 25000.00, 3);

INSERT INTO emp (emp_id, emp_name, job_title, salary, department_id)
VALUES (103, 'Rahul Singh', 'Accountant', 40000.00, 2);

INSERT INTO emp (emp_id, emp_name, job_title, salary, department_id)
(104, 'Sita Rai', 'Marketing Executive', 35000.00, 4);




MERGE INTO emp H USING DEPT_SALARY_ADJUSTMENT D
ON(H.DEPARTMENT_ID=D.DEPARTMENT_ID)
WHEN MATCHED THEN
    UPDATE SET H.SALARY =H.SALARY + (D.ADJUSTMENT_PERCENT * H.SALARY);

SELECT * FROM emp;


